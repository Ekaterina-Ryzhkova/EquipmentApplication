@page "/addPerson"

@using System
@using System.Linq
@using EquipmentApplication.Shared
@using static MudBlazor.CategoryTypes;

@inject NavigationManager NavigationManager
@inject MudBlazor.ISnackbar snackbar
@inject IJSRuntime JsRuntime

<MudBreadcrumbs Items="_items"></MudBreadcrumbs>

<MudCard Elevation="25" Style="max-width: 960px;">
    <MudCardHeader>
        <CardHeaderContent>
            <MudText Typo="Typo.h6">Добавить ответственное лицо</MudText>
        </CardHeaderContent>
    </MudCardHeader>
    <MudCardContent>
        <EditForm OnValidSubmit="Add" Model="@person">
            <MudTextField @bind-Value="person.FullName" Label="Ответственное лицо"></MudTextField>
            <MudTextField @bind-Value="person.Position" Label="Должность"></MudTextField>
            <br />
            <MudButton Color="Color.Info" Variant="Variant.Filled" OnClick="Add">Добавить</MudButton>
        </EditForm>
    </MudCardContent>
</MudCard>

@code {
    [Parameter] public ResponsePerson person { get; set; } = new ResponsePerson();

    private List<BreadcrumbItem> _items = new List<BreadcrumbItem>
    {
        new BreadcrumbItem("Главная", href: "/"),
        new BreadcrumbItem("Ответственные лица", href: "person"),
        new BreadcrumbItem("Добавить", href: null, disabled: true)
    };

    private void Add()
    {
        if (person.Id == 0)
        {
            responsePersonService.Add(person);
            snackbar.Add("Добавлено ответственное лицо",
            Severity.Success);
        }

        person = new ResponsePerson();
        responsePersonService.GetAll();
        NavigationManager.NavigateTo("person");
    }
}
